import{r,j as e,q as F,J as y,T as N,W as P,S as $,b as I,s as w}from"./index-D7DAox1V.js";import{S as R}from"./StatusBadge-CCWrMZb5.js";import{E as L}from"./AdminDashboard-_xoncaYT.js";import{C as z}from"./circle-check-B6lhUXNb.js";import{B as K}from"./ban-CaJHeb01.js";import{F as V}from"./filter-DJVJxnfy.js";import{B as v}from"./building-BTZaUNff.js";import{C as J}from"./calendar-CC1mERTk.js";import{E as M}from"./eye-D127WwNK.js";import"./activity-boTQSFBB.js";import"./tag-BL8Qmre2.js";import"./wallet-DCz2Uy4f.js";import"./credit-card-Bx9QuFqM.js";import"./star-DIAfouR6.js";import"./log-out-CHdvlf2Q.js";import"./file-text-CoQrWOnj.js";import"./dollar-sign-ewyyKfX1.js";import"./circle-check-big-BWYsEs7U.js";import"./shield-CS6reTNY.js";import"./user-plus-bY2NAf9m.js";import"./square-pen-ByzbfLyF.js";import"./trash-2-pXfwjhmN.js";import"./mail-G-y0M2XW.js";const ue=({onShowVehicleDetail:h})=>{const[t,S]=r.useState([]),[D,j]=r.useState(!0),[f,b]=r.useState(null),[d,k]=r.useState("all"),[i,C]=r.useState("all"),[T,B]=r.useState([]),[c,E]=r.useState(""),[x,W]=r.useState(""),[g,Y]=r.useState(""),p=async()=>{j(!0),b(null);try{const[s,l]=await Promise.all([w.partnerVehicles.getAll(),w.partners.getAll()]),u=new Map;l.forEach(a=>u.set(a.id,a.name||a.company_name||"Bilinmeyen"));const n=s.map(a=>({...a,partnerId:a.partnerId||a.partner_id||"",partnerName:a.partnerName||u.get(a.partnerId||a.partner_id)||"Bilinmeyen Partner"}));S(n),B(l)}catch(s){console.error("Fleet data load error:",s),b("Araç verileri yüklenirken hata oluştu.")}finally{j(!1)}};r.useEffect(()=>{p()},[]);const o=t.filter(s=>{if(d!=="all"&&s.status!==d||i!=="all"&&s.partnerId!==i)return!1;if(c){const l=c.toLowerCase();if(![s.plate,s.partnerName,s.brand,s.model,s.driver,s.type].filter(Boolean).some(n=>n==null?void 0:n.toLowerCase().includes(l)))return!1}if(x||g){const l=new Date(s.registrationDate);if(x&&l<new Date(x)||g&&l>new Date(g))return!1}return!0}),m={total:t.length,active:t.filter(s=>s.status==="active").length,maintenance:t.filter(s=>s.status==="maintenance").length,disabled:t.filter(s=>s.status==="disabled").length},A=s=>s?new Date(s).toLocaleDateString("tr-TR"):"-",_=s=>s==null?"-":new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(s);return D?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):f?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[e.jsx(F,{className:"w-5 h-5"}),e.jsx("span",{children:f})]}),e.jsxs("button",{onClick:p,className:"mt-3 flex items-center gap-2 px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",children:[e.jsx(y,{className:"w-4 h-4"}),"Tekrar Dene"]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:e.jsx(N,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Toplam Araç"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.total})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:e.jsx(z,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Aktif"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:m.active})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-yellow-100 p-3 rounded-lg",children:e.jsx(P,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Bakımda"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:m.maintenance})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-red-100 p-3 rounded-lg",children:e.jsx(K,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Devre Dışı"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:m.disabled})]})]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 border border-gray-200",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Plaka, firma, marka, model veya sürücü ara...",value:c,onChange:s=>E(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),e.jsx("div",{className:"w-full lg:w-48",children:e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsxs("select",{value:d,onChange:s=>k(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none bg-white",children:[e.jsx("option",{value:"all",children:"Tüm Durumlar"}),e.jsx("option",{value:"active",children:"Aktif"}),e.jsx("option",{value:"maintenance",children:"Bakımda"}),e.jsx("option",{value:"disabled",children:"Devre Dışı"})]})]})}),e.jsx("div",{className:"w-full lg:w-56",children:e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsxs("select",{value:i,onChange:s=>C(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none bg-white",children:[e.jsx("option",{value:"all",children:"Tüm Partnerler"}),T.map(s=>e.jsx("option",{value:s.id,children:s.name||s.company_name||"Bilinmeyen"},s.id))]})]})}),e.jsxs("button",{onClick:p,className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Yenile"})]})]})}),o.length===0?e.jsx(L,{title:"Araç Bulunamadı",description:c||d!=="all"||i!=="all"?"Arama kriterlerinize uygun araç bulunamadı.":"Henüz kayıtlı araç bulunmuyor."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:o.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"h-40 bg-gray-100 relative",children:[s.image||s.front_photo_url?e.jsx("img",{src:s.image||s.front_photo_url,alt:`${s.brand} ${s.model}`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(N,{className:"w-16 h-16 text-gray-300"})}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(R,{type:"vehicle",status:s.status})})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900",children:s.plate}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.brand," ",s.model," ",s.year&&`(${s.year})`]})]}),e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded",children:s.type||s.vehicle_type||"Kamyon"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(v,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{children:s.partnerName})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(I,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{children:s.driver||"Sürücü atanmamış"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(J,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{children:["Kayıt: ",A(s.registrationDate)]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:s.totalJobs||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Toplam İş"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-bold text-green-600",children:_(s.totalEarnings)}),e.jsx("p",{className:"text-xs text-gray-500",children:"Kazanç"})]}),h&&e.jsxs("button",{onClick:()=>h(s.id),className:"flex items-center gap-1 px-3 py-1.5 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors text-sm",children:[e.jsx(M,{className:"w-4 h-4"}),"Detay"]})]})]})]},s.id))}),e.jsx("div",{className:"text-sm text-gray-500 text-center",children:o.length===t.length?`Toplam ${t.length} araç`:`${o.length} / ${t.length} araç gösteriliyor`})]})};export{ue as AdminFleetTab,ue as default};
