import{r as i,j as e,X as z,f as n}from"./index-C8l4yRJn.js";import{T as S,B as K}from"./UIComponents-Ck4de74E.js";import{P as E}from"./plus-7_qfzzRh.js";import{G as A}from"./gift-3yepzVsS.js";import{E as T}from"./eye-off-B7KbDj87.js";import{E as P}from"./eye-ITOk9SW5.js";import{P as B}from"./pen-DSFzK5iv.js";import{T as G}from"./trash-2-Z4xbFMtr.js";import{T as Y}from"./tag-WQEd_zuG.js";import{P as D}from"./percent-CRMCsZEd.js";import{C as F}from"./calendar-DkhWvn5o.js";import{S as M}from"./save-ekK4yUqn.js";const x={title:"",description:"",image_url:"",badge_text:"",valid_until:"",discount:"",code:"",is_active:!0,sort_order:"0",start_date:"",end_date:""},W=()=>{const[m,v]=i.useState([]),[j,u]=i.useState(!0),[b,l]=i.useState(""),[y,d]=i.useState(!1),[s,a]=i.useState(x),[g,p]=i.useState(!1),[N,h]=i.useState(null),o=async()=>{u(!0),l("");try{const t=await n.getAll();v(t)}catch(t){console.error("Campaigns load error:",t),l((t==null?void 0:t.message)||"Kampanyalar yüklenemedi")}finally{u(!1)}};i.useEffect(()=>{o()},[]);const f=()=>{a(x),d(!0)},_=t=>{var r;a({id:t.id,title:t.title,description:t.description,image_url:t.image_url,badge_text:t.badge_text||"",valid_until:t.valid_until||"",discount:((r=t.discount)==null?void 0:r.toString())||"",code:t.code||"",is_active:t.is_active,sort_order:t.sort_order.toString(),start_date:t.start_date||"",end_date:t.end_date||""}),d(!0)},k=async()=>{if(!s.title||!s.description||!s.image_url){l("Başlık, açıklama ve görsel URL zorunludur");return}p(!0),l("");try{const t={title:s.title,description:s.description,image_url:s.image_url,badge_text:s.badge_text||void 0,valid_until:s.valid_until||void 0,discount:s.discount?parseInt(s.discount):void 0,code:s.code||void 0,is_active:s.is_active,sort_order:parseInt(s.sort_order)||0,start_date:s.start_date||void 0,end_date:s.end_date||void 0};s.id?await n.update(s.id,t):await n.create(t),d(!1),a(x),await o()}catch(t){console.error("Campaign save error:",t),l((t==null?void 0:t.message)||"Kampanya kaydedilemedi")}finally{p(!1)}},w=async t=>{if(confirm("Bu kampanyayı silmek istediğinizden emin misiniz?")){h(t);try{await n.delete(t),await o()}catch(r){console.error("Campaign delete error:",r),l((r==null?void 0:r.message)||"Kampanya silinemedi")}finally{h(null)}}},C=async(t,r)=>{try{await n.toggleActive(t,!r),await o()}catch(c){console.error("Toggle active error:",c),l((c==null?void 0:c.message)||"Durum değiştirilemedi")}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Kampanya Yönetimi"}),e.jsxs("button",{onClick:f,className:"flex items-center gap-2 px-4 py-2 bg-brand-orange text-white rounded-xl font-bold text-sm hover:bg-orange-600 transition-colors",children:[e.jsx(E,{size:18}),"Yeni Kampanya"]})]}),b&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 text-red-700 text-sm",children:[b,e.jsx("button",{onClick:()=>l(""),className:"ml-2 underline",children:"Kapat"})]}),j?e.jsx(S,{rows:4}):m.length===0?e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-8 text-center",children:[e.jsx(A,{size:48,className:"mx-auto text-slate-300 mb-4"}),e.jsx("p",{className:"text-slate-500",children:"Henüz kampanya eklenmemiş"}),e.jsx("button",{onClick:f,className:"mt-4 px-4 py-2 bg-brand-orange text-white rounded-lg font-bold text-sm",children:"İlk Kampanyayı Ekle"})]}):e.jsx("div",{className:"grid gap-4",children:m.map(t=>e.jsx("div",{className:`bg-white rounded-2xl border overflow-hidden ${t.is_active?"border-slate-200":"border-slate-300 opacity-60"}`,children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-40 h-32 flex-shrink-0",children:e.jsx("img",{src:t.image_url,alt:t.title,className:"w-full h-full object-cover",onError:r=>{r.target.src="https://via.placeholder.com/160x128?text=Görsel+Yok"}})}),e.jsxs("div",{className:"flex-1 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-bold text-slate-900",children:t.title}),e.jsx(K,{variant:t.is_active?"success":"neutral",children:t.is_active?"Aktif":"Pasif"})]}),e.jsx("p",{className:"text-sm text-slate-500 line-clamp-2",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>C(t.id,t.is_active),className:`p-2 rounded-lg ${t.is_active?"bg-slate-100 text-slate-600 hover:bg-slate-200":"bg-green-100 text-green-600 hover:bg-green-200"}`,title:t.is_active?"Pasife Al":"Aktif Et",children:t.is_active?e.jsx(T,{size:18}):e.jsx(P,{size:18})}),e.jsx("button",{onClick:()=>_(t),className:"p-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200",title:"Düzenle",children:e.jsx(B,{size:18})}),e.jsx("button",{onClick:()=>w(t.id),disabled:N===t.id,className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 disabled:opacity-50",title:"Sil",children:e.jsx(G,{size:18})})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-xs text-slate-500",children:[t.badge_text&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Y,{size:14}),t.badge_text]}),t.discount&&e.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(D,{size:14}),"%",t.discount," İndirim"]}),t.valid_until&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(F,{size:14}),t.valid_until]}),t.code&&e.jsx("span",{className:"flex items-center gap-1 font-mono bg-slate-100 px-2 py-0.5 rounded",children:t.code})]})]})]})},t.id))}),y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-lg",children:s.id?"Kampanya Düzenle":"Yeni Kampanya"}),e.jsx("button",{onClick:()=>d(!1),className:"p-2 hover:bg-slate-100 rounded-lg",children:e.jsx(z,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Başlık *"}),e.jsx("input",{type:"text",value:s.title,onChange:t=>a({...s,title:t.target.value}),className:"w-full border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-brand-orange focus:border-transparent",placeholder:"Kampanya başlığı"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Açıklama *"}),e.jsx("textarea",{value:s.description,onChange:t=>a({...s,description:t.target.value}),className:"w-full border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-brand-orange focus:border-transparent resize-none",rows:3,placeholder:"Kampanya açıklaması"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Görsel URL *"}),e.jsx("input",{type:"text",value:s.image_url,onChange:t=>a({...s,image_url:t.target.value}),className:"w-full border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-brand-orange focus:border-transparent",placeholder:"https://..."}),s.image_url&&e.jsx("div",{className:"mt-2 rounded-lg overflow-hidden w-32 h-24 bg-slate-100",children:e.jsx("img",{src:s.image_url,alt:"Preview",className:"w-full h-full object-cover",onError:t=>{t.target.style.display="none"}})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Etiket (Badge)"}),e.jsx("input",{type:"text",value:s.badge_text,onChange:t=>a({...s,badge_text:t.target.value}),className:"w-full border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-brand-orange focus:border-transparent",placeholder:"Örn: %30 İndirim, Yeni Üyelere Özel"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"İndirim (%)"}),e.jsx("input",{type:"number",value:s.discount,onChange:t=>a({...s,discount:t.target.value}),className:"w-full border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-brand-orange focus:border-transparent",placeholder:"30",min:"0",max:"100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Kupon Kodu"}),e.jsx("input",{type:"text",value:s.code,onChange:t=>a({...s,code:t.target.value.toUpperCase()}),className:"w-full border border-slate-200 rounded-xl px-4 py-3 text-sm font-mono focus:ring-2 focus:ring-brand-orange focus:border-transparent",placeholder:"KAMPANYA30"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Geçerlilik Tarihi (Metin)"}),e.jsx("input",{type:"text",value:s.valid_until,onChange:t=>a({...s,valid_until:t.target.value}),className:"w-full border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-brand-orange focus:border-transparent",placeholder:"31 Aralık 2024"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Sıralama"}),e.jsx("input",{type:"number",value:s.sort_order,onChange:t=>a({...s,sort_order:t.target.value}),className:"w-full border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-brand-orange focus:border-transparent",placeholder:"0",min:"0"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Başlangıç Tarihi"}),e.jsx("input",{type:"datetime-local",value:s.start_date,onChange:t=>a({...s,start_date:t.target.value}),className:"w-full border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-brand-orange focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Bitiş Tarihi (Geri Sayım)"}),e.jsx("input",{type:"datetime-local",value:s.end_date,onChange:t=>a({...s,end_date:t.target.value}),className:"w-full border border-slate-200 rounded-xl px-4 py-3 text-sm focus:ring-2 focus:ring-brand-orange focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"is_active",checked:s.is_active,onChange:t=>a({...s,is_active:t.target.checked}),className:"w-5 h-5 rounded border-slate-300 text-brand-orange focus:ring-brand-orange"}),e.jsx("label",{htmlFor:"is_active",className:"text-sm text-slate-700",children:"Kampanya aktif olarak yayınlansın"})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-200 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>d(!1),className:"px-6 py-3 border border-slate-200 rounded-xl text-sm font-bold text-slate-600 hover:bg-slate-50",children:"İptal"}),e.jsx("button",{onClick:k,disabled:g,className:"px-6 py-3 bg-brand-orange text-white rounded-xl text-sm font-bold hover:bg-orange-600 disabled:opacity-50 flex items-center gap-2",children:g?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Kaydediliyor..."]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{size:18}),"Kaydet"]})})]})]})})]})};export{W as default};
