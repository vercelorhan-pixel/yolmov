import{c as K,r,j as e,P as U,M as G,L as g,p as S,X as O,S as X,a8 as j,a9 as Y}from"./index-BrwBfCHk.js";import{B as P,T as $}from"./UIComponents-Bfu9gZEO.js";import{A as q}from"./arrow-left-yMlh3HP8.js";import{S as V}from"./shield-o3g8mYdO.js";import{M as J}from"./mail-C-mRnHGA.js";import{C as Q}from"./calendar-B7qGfZT7.js";import{S as W}from"./star-Dj4l-0VP.js";import{C as f}from"./circle-check-CpIGVDf2.js";import{D as Z}from"./dollar-sign-BI4T61k8.js";import{B as A}from"./building-oEnpzL1F.js";import{F as ee}from"./file-text-DOqOdPPr.js";import{I as T}from"./image-COkp4WGq.js";import{E as N}from"./eye-ByG49gIl.js";import{E as se}from"./external-link-BXlOl3Hf.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=K("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]),L=o=>{switch(o){case"active":return{text:"Aktif",variant:"success"};case"pending":return{text:"Beklemede",variant:"warning"};case"suspended":return{text:"Askıda",variant:"error"};default:return{text:"Bilinmiyor",variant:"neutral"}}},pe=()=>{var _;const[o,D]=r.useState(""),[E,v]=r.useState(!0),[I,F]=r.useState([]),[y,m]=r.useState(""),[h,M]=r.useState(""),[x,p]=r.useState(null),[R,w]=r.useState(!1),[i,u]=r.useState(null),[n,k]=r.useState(!1),z=async()=>{v(!0),m("");try{const s=await j.getAll();F(s)}catch(s){console.error("Partner load error:",s),m((s==null?void 0:s.message)||"Partnerler yüklenemedi")}finally{v(!1)}};r.useEffect(()=>{z()},[]);const H=async s=>{w(!0);try{const t=(await j.getAll()).find(l=>l.id===s);if(t){try{const l=await Y.getByPartnerId(t.id);l&&(t.credits=l.balance)}catch{console.log("Credit info not found for partner")}p(t)}}catch(a){console.error("Partner detail load error:",a),m((a==null?void 0:a.message)||"Partner detayları yüklenemedi")}finally{w(!1)}},c=async(s,a)=>{k(!0);try{await j.update(s,{status:a}),x&&x.id===s&&p({...x,status:a}),await z()}catch(t){console.error("Status update error:",t),m((t==null?void 0:t.message)||"Durum güncellenemedi")}finally{k(!1)}},b=I.filter(s=>{if(o&&s.status!==o)return!1;if(h){const a=h.toLowerCase(),t=(s.company_name||s.name||"").toLowerCase(),l=(s.email||"").toLowerCase(),d=(s.phone||"").toLowerCase();return t.includes(a)||l.includes(a)||d.includes(a)}return!0});if(x){const s=x,a=s.company_name||s.name||"Partner",t=L(s.status);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>p(null),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors flex items-center gap-2 text-slate-600",children:[e.jsx(q,{size:20}),"Geri"]}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Partner Detayı"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center text-white text-2xl font-bold",children:e.jsx(V,{size:32})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:a}),e.jsxs("p",{className:"text-sm text-slate-600",children:[s.first_name," ",s.last_name]}),e.jsx("p",{className:"text-xs text-slate-500",children:s.id})]})]}),e.jsx(P,{variant:t.variant,className:"px-4 py-2 text-sm font-bold",children:t.text})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 rounded-xl",children:[e.jsx(J,{size:20,className:"text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Email"}),e.jsx("p",{className:"font-medium text-slate-900 text-sm",children:s.email})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 rounded-xl",children:[e.jsx(U,{size:20,className:"text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Telefon"}),e.jsx("p",{className:"font-medium text-slate-900 text-sm",children:s.phone})]})]}),s.city&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 rounded-xl",children:[e.jsx(G,{size:20,className:"text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Konum"}),e.jsxs("p",{className:"font-medium text-slate-900 text-sm",children:[s.district,", ",s.city]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-50 rounded-xl",children:[e.jsx(Q,{size:20,className:"text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Kayıt Tarihi"}),e.jsx("p",{className:"font-medium text-slate-900 text-sm",children:new Date(s.created_at).toLocaleDateString("tr-TR")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-yellow-50 rounded-xl border border-yellow-200",children:[e.jsx(W,{size:20,className:"text-yellow-500 fill-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-yellow-700",children:"Puan"}),e.jsx("p",{className:"font-bold text-slate-900",children:((_=s.rating)==null?void 0:_.toFixed(2))||"0.00"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 rounded-xl border border-green-200",children:[e.jsx(f,{size:20,className:"text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-700",children:"Tamamlanan İşler"}),e.jsx("p",{className:"font-bold text-slate-900",children:s.completed_jobs||0})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-orange-50 rounded-xl border border-orange-200",children:[e.jsx(Z,{size:20,className:"text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-orange-700",children:"Kredi Bakiyesi"}),e.jsx("p",{className:"font-bold text-slate-900",children:s.credits||0})]})]})]}),(s.tax_number||s.trade_registry_number)&&e.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-xl",children:[e.jsxs("h4",{className:"text-sm font-bold text-slate-900 mb-3 flex items-center gap-2",children:[e.jsx(A,{size:16,className:"text-slate-600"}),"Şirket Bilgileri"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.tax_number&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Vergi Numarası"}),e.jsx("p",{className:"font-medium text-slate-900",children:s.tax_number})]}),s.trade_registry_number&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Ticaret Sicil No"}),e.jsx("p",{className:"font-medium text-slate-900",children:s.trade_registry_number})]})]})]}),s.service_types&&s.service_types.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-bold text-slate-900 mb-2",children:"Hizmet Tipleri"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.service_types.map((l,d)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-lg text-sm font-medium",children:l},d))})]}),(s.commercial_registry_url||s.vehicle_license_url)&&e.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-xl",children:[e.jsxs("h4",{className:"text-sm font-bold text-slate-900 mb-3 flex items-center gap-2",children:[e.jsx(ee,{size:16,className:"text-blue-600"}),"Yüklenen Belgeler"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.commercial_registry_url&&e.jsxs("button",{onClick:()=>u({url:s.commercial_registry_url,title:"Ticari Sicil Belgesi"}),className:"flex items-center gap-3 p-4 bg-white border border-blue-200 rounded-xl hover:bg-blue-50 transition-colors text-left group",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-200 transition-colors",children:e.jsx(T,{size:24,className:"text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-bold text-slate-900",children:"Ticari Sicil Belgesi"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Tıklayarak önizleyin"})]}),e.jsx(N,{size:20,className:"text-blue-600"})]}),s.vehicle_license_url&&e.jsxs("button",{onClick:()=>u({url:s.vehicle_license_url,title:"Araç Ruhsatı"}),className:"flex items-center gap-3 p-4 bg-white border border-green-200 rounded-xl hover:bg-green-50 transition-colors text-left group",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center group-hover:bg-green-200 transition-colors",children:e.jsx(T,{size:24,className:"text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-bold text-slate-900",children:"Araç Ruhsatı"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Tıklayarak önizleyin"})]}),e.jsx(N,{size:20,className:"text-green-600"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-slate-200",children:[s.status!=="active"&&e.jsxs("button",{onClick:()=>c(s.id,"active"),disabled:n,className:"px-6 py-3 bg-green-600 text-white rounded-xl font-bold hover:bg-green-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[n?e.jsx(g,{size:18,className:"animate-spin"}):e.jsx(f,{size:18}),"Onayla"]}),s.status!=="pending"&&e.jsxs("button",{onClick:()=>c(s.id,"pending"),disabled:n,className:"px-6 py-3 bg-yellow-500 text-white rounded-xl font-bold hover:bg-yellow-600 transition-colors flex items-center gap-2 disabled:opacity-50",children:[n?e.jsx(g,{size:18,className:"animate-spin"}):e.jsx(B,{size:18}),"Beklemeye Al"]}),s.status!=="suspended"&&e.jsxs("button",{onClick:()=>c(s.id,"suspended"),disabled:n,className:"px-6 py-3 bg-red-600 text-white rounded-xl font-bold hover:bg-red-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[n?e.jsx(g,{size:18,className:"animate-spin"}):e.jsx(S,{size:18}),"Askıya Al"]})]})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>u(null),children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 flex items-center justify-between bg-slate-50",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:i.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(se,{size:16}),"Yeni Sekmede Aç"]}),e.jsx("button",{onClick:()=>u(null),className:"p-2 text-slate-400 hover:text-slate-600 rounded-lg hover:bg-slate-100 transition-colors",children:e.jsx(O,{size:20})})]})]}),e.jsx("div",{className:"p-4 bg-slate-100 flex items-center justify-center",style:{minHeight:"500px"},children:e.jsx("img",{src:i.url,alt:i.title,className:"max-w-full max-h-[70vh] object-contain rounded-lg shadow-lg",onError:l=>{const d=l.target;d.style.display="none";const C=d.parentElement;C&&(C.innerHTML=`
                        <div class="text-center p-8">
                          <p class="text-slate-600 mb-4">Önizleme yapılamıyor. Belgeyi yeni sekmede açın.</p>
                          <a href="${i.url}" target="_blank" class="px-6 py-3 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 inline-block">
                            Belgeyi Aç
                          </a>
                        </div>
                      `)}})})]})})]})}return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Partnerler"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(X,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Partner ara...",value:h,onChange:s=>M(s.target.value),className:"pl-10 pr-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none"})]}),e.jsxs("select",{className:"border border-slate-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none",value:o,onChange:s=>D(s.target.value),children:[e.jsx("option",{value:"",children:"Tümü"}),e.jsx("option",{value:"pending",children:"Beklemede"}),e.jsx("option",{value:"active",children:"Aktif"}),e.jsx("option",{value:"suspended",children:"Askıda"})]})]})]}),E?e.jsx($,{rows:6}):y?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 text-red-700 text-sm",children:y}):b.length===0?e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-8 text-center",children:[e.jsx(A,{size:48,className:"mx-auto text-slate-300 mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-slate-700 mb-2",children:"Partner Bulunamadı"}),e.jsx("p",{className:"text-slate-500",children:"Arama kriterlerinize uygun partner yok."})]}):e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-50 p-4 border-b border-slate-200 text-sm font-bold",children:["Toplam: ",b.length," partner"]}),e.jsx("div",{className:"divide-y divide-slate-100",children:b.map(s=>{const a=L(s.status),t=s.company_name||s.name||"Partner",l=s.profile_photo_url||s.logo_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=6366f1&color=fff&size=64`;return e.jsxs("div",{className:"p-4 flex items-center gap-4 hover:bg-slate-50 transition-colors",children:[e.jsx("img",{src:l,alt:t,className:"w-12 h-12 rounded-full object-cover border-2 border-slate-200 shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-bold text-slate-900 text-sm truncate",children:t}),e.jsxs("div",{className:"text-xs text-slate-500 truncate",children:[s.email," • ",s.phone]}),e.jsxs("div",{className:"text-xs text-slate-500",children:[s.city||"-"," / ",s.district||"-"]})]}),e.jsx(P,{variant:a.variant,children:a.text}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>H(s.id),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Detayları Gör",children:R?e.jsx(g,{size:18,className:"animate-spin"}):e.jsx(N,{size:18})}),e.jsx("button",{className:"px-3 py-2 bg-green-600 text-white rounded-lg text-xs font-bold hover:bg-green-700 flex items-center gap-1",onClick:()=>c(s.id,"active"),title:"Onayla",children:e.jsx(f,{size:16})}),e.jsx("button",{className:"px-3 py-2 bg-yellow-500 text-white rounded-lg text-xs font-bold hover:bg-yellow-600 flex items-center gap-1",onClick:()=>c(s.id,"pending"),title:"Beklemeye Al",children:e.jsx(B,{size:16})}),e.jsx("button",{className:"px-3 py-2 bg-red-600 text-white rounded-lg text-xs font-bold hover:bg-red-700 flex items-center gap-1",onClick:()=>c(s.id,"suspended"),title:"Askıya Al",children:e.jsx(S,{size:16})})]})]},s.id)})})]})]})};export{pe as default};
