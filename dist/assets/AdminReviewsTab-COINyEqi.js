import{c as v,u as k,r as d,j as e,V as z,w as R,S as w,s as S}from"./index-DU7nbpgv.js";import{u as T,E as A}from"./AdminDashboard-MKvuI3Rp.js";import{S as n}from"./star-C2f4Ixfu.js";import{E as I}from"./eye-D_IlimC5.js";import"./activity-BQdV48A4.js";import"./tag-D2MwiuJA.js";import"./wallet-tsKlKHJd.js";import"./credit-card-B2T1ZE3V.js";import"./log-out-CiWxhRJa.js";import"./file-text-Cb_J7V6z.js";import"./calendar-DDP1yapL.js";import"./dollar-sign-CEzCbDHU.js";import"./circle-check-big-DW0hV3wO.js";import"./StatusBadge-DDuB58ui.js";import"./shield-Cwqi9Tz_.js";import"./user-plus-B07g1W6D.js";import"./square-pen-Be3Ln_Ki.js";import"./trash-2-BMsrf-7D.js";import"./mail-Bj5KUDK6.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=v("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]),j=[{id:"REV-001",jobId:"JOB-4923",partnerId:"PTR-001",partnerName:"Yılmaz Oto Kurtarma",customerName:"Ahmet Yılmaz",service:"Çekici Hizmeti",date:"2024-11-22 15:30",rating:5,comment:"Çok hızlı geldi, işini profesyonelce yaptı. Teşekkürler!",tags:["Kibar Müşteri","Sorunsuz Ödeme","Bahşiş Bıraktı"]},{id:"REV-002",jobId:"JOB-4920",partnerId:"PTR-001",partnerName:"Yılmaz Oto Kurtarma",customerName:"Mehmet K.",service:"Akü Takviyesi",date:"2024-11-19 10:15",rating:2,comment:"Geç geldi, müşteri hizmetleri vasat.",tags:["Geç Geldi","İletişim Zor"],objection:{reason:"Haksız değerlendirme",details:"Trafikte kaza oldu, bu yüzden geç kaldım. Müşteriye bilgi verdim ama yine de kötü puan verdi.",submittedAt:"2024-11-19 16:00",status:"pending"}},{id:"REV-003",jobId:"JOB-4918",partnerId:"PTR-002",partnerName:"Hızlı Yol Yardım",customerName:"Selin Kaya",service:"Çekici Hizmeti",date:"2024-11-15 14:00",rating:4,comment:"Gayet iyiydi, fiyat biraz yüksek geldi ama memnunum.",tags:["Anlayışlı","İletişim Kolaydı"]},{id:"REV-004",jobId:"JOB-4915",partnerId:"PTR-002",partnerName:"Hızlı Yol Yardım",customerName:"Burak Y.",service:"Çekici Hizmeti",date:"2024-11-12 09:30",rating:1,comment:"Çok kötü bir deneyimdi, asla tavsiye etmem.",tags:["Kaba Davranış","Ödeme Sorunu"],objection:{reason:"Müşteri saldırgan davrandı",details:"Müşteri sarhoş ve saldırgan davrandı. Poliçe tutanak var. Bu değerlendirme haksız.",submittedAt:"2024-11-12 14:00",status:"approved",resolvedBy:"Admin User",resolvedAt:"2024-11-13 10:00"}},{id:"REV-005",jobId:"JOB-4912",partnerId:"PTR-003",partnerName:"Mega Çekici",customerName:"Zeynep Aydın",service:"Lastik Değişimi",date:"2024-11-10 16:45",rating:5,comment:"Hayat kurtardınız! Çok teşekkürler, kesinlikle tavsiye ederim.",tags:["Konum Doğruydu","Sorunsuz Ödeme"]},{id:"REV-006",jobId:"JOB-4910",partnerId:"PTR-003",partnerName:"Mega Çekici",customerName:"Caner Erkin",service:"Yakıt Desteği",date:"2024-11-08 11:20",rating:5,comment:"Çok hızlı ve profesyonel hizmet. Teşekkürler!",tags:["Kibar Müşteri","Konum Doğruydu"]},{id:"REV-007",jobId:"JOB-4908",partnerId:"PTR-001",partnerName:"Yılmaz Oto Kurtarma",customerName:"Elif Demir",service:"Çekici Hizmeti",date:"2024-11-05 08:45",rating:3,comment:"İdare eder, fiyat biraz yüksek.",tags:["Ödeme Sorunu"]}],W=()=>{const x=k(),[s,f]=d.useState([]),[N,p]=d.useState(!0),[l,o]=d.useState("all"),u=async()=>{p(!0);try{const t=await S.partnerReviews.getAll();if(t&&Array.isArray(t)){const r=t.map(a=>({id:a.id,jobId:a.jobId||"",partnerId:a.partnerId||"",partnerName:a.partnerName||"Partner",customerName:a.customerName||"Müşteri",service:a.service||"Hizmet",date:a.createdAt?new Date(a.createdAt).toLocaleString("tr-TR"):"",rating:a.rating,comment:a.comment||"",tags:a.tags||[]}));f(r),console.log("⭐ [AdminReviewsTab] Loaded reviews:",r.length)}}catch(t){console.error("Error loading reviews:",t)}finally{p(!1)}};d.useEffect(()=>{u()},[]);const{filtered:b,searchTerm:y,setSearchTerm:c}=T(s,{searchKeys:["partnerName","customerName","service"]}),g=l==="all"?b:b.filter(t=>l===2?t.rating<=2:t.rating===l),i={total:s.length,avgRating:(s.reduce((t,r)=>t+r.rating,0)/s.length).toFixed(1),fiveStar:s.filter(t=>t.rating===5).length,fourStar:s.filter(t=>t.rating===4).length,threeStar:s.filter(t=>t.rating===3).length,lowRating:s.filter(t=>t.rating<=2).length,objections:s.filter(t=>t.objection).length,pendingObjections:s.filter(t=>{var r;return((r=t.objection)==null?void 0:r.status)==="pending"}).length},h=t=>t>=4?"text-green-600":t===3?"text-yellow-600":"text-red-600";return N?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-orange-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Müşteri Değerlendirmeleri"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Toplam ",s.length," değerlendirme"]})]}),e.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg text-sm font-medium text-slate-700 transition-colors",children:[e.jsx(z,{size:16}),"Yenile"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(n,{size:20,className:"text-yellow-400",fill:"#FBBF24"}),e.jsx("span",{className:"text-xs font-bold text-slate-500",children:"Ortalama"})]}),e.jsx("p",{className:"text-2xl font-black text-slate-900",children:i.avgRating})]}),e.jsxs("button",{onClick:()=>o("all"),className:`bg-white rounded-xl border-2 p-4 text-left transition-all ${l==="all"?"border-slate-400":"border-slate-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(n,{size:20,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-bold text-slate-500",children:"Tümü"})]}),e.jsx("p",{className:"text-2xl font-black text-slate-900",children:i.total})]}),e.jsxs("button",{onClick:()=>o(5),className:`bg-green-50 rounded-xl border-2 p-4 text-left transition-all ${l===5?"border-green-400":"border-green-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(n,{size:20,className:"text-green-600",fill:"#16a34a"}),e.jsx("span",{className:"text-xs font-bold text-green-600",children:"5★"})]}),e.jsx("p",{className:"text-2xl font-black text-green-700",children:i.fiveStar})]}),e.jsxs("button",{onClick:()=>o(4),className:`bg-blue-50 rounded-xl border-2 p-4 text-left transition-all ${l===4?"border-blue-400":"border-blue-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(n,{size:20,className:"text-blue-600",fill:"#2563eb"}),e.jsx("span",{className:"text-xs font-bold text-blue-600",children:"4★"})]}),e.jsx("p",{className:"text-2xl font-black text-blue-700",children:i.fourStar})]}),e.jsxs("button",{onClick:()=>o(3),className:`bg-yellow-50 rounded-xl border-2 p-4 text-left transition-all ${l===3?"border-yellow-400":"border-yellow-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(n,{size:20,className:"text-yellow-600",fill:"#ca8a04"}),e.jsx("span",{className:"text-xs font-bold text-yellow-600",children:"3★"})]}),e.jsx("p",{className:"text-2xl font-black text-yellow-700",children:i.threeStar})]}),e.jsxs("button",{onClick:()=>o(2),className:`bg-red-50 rounded-xl border-2 p-4 text-left transition-all ${l===2?"border-red-400":"border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(E,{size:20,className:"text-red-600"}),e.jsx("span",{className:"text-xs font-bold text-red-600",children:"≤2★"})]}),e.jsx("p",{className:"text-2xl font-black text-red-700",children:i.lowRating})]}),e.jsxs("div",{className:"bg-orange-50 rounded-xl border border-orange-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(R,{size:20,className:"text-orange-600"}),e.jsx("span",{className:"text-xs font-bold text-orange-600",children:"İtiraz"})]}),e.jsxs("p",{className:"text-2xl font-black text-orange-700",children:[i.pendingObjections,"/",i.objections]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(w,{size:20,className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Partner, müşteri veya hizmet ara...",className:"w-full pl-12 pr-4 py-3 bg-white border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none",value:y,onChange:t=>c(t.target.value)})]}),e.jsxs("select",{className:"px-4 py-3 bg-white border border-slate-200 rounded-xl font-medium text-slate-700 focus:ring-2 focus:ring-blue-500 outline-none",onChange:t=>c(t.target.value==="all"?"":t.target.value),children:[e.jsx("option",{value:"all",children:"Tüm Partnerler"}),[...new Set(j.map(t=>t.partnerName))].sort().map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{className:"px-4 py-3 bg-white border border-slate-200 rounded-xl font-medium text-slate-700 focus:ring-2 focus:ring-blue-500 outline-none",onChange:t=>c(t.target.value==="all"?"":t.target.value),children:[e.jsx("option",{value:"all",children:"Tüm Hizmetler"}),[...new Set(j.map(t=>t.service))].sort().map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 overflow-hidden",children:g.length===0?e.jsx(A,{title:"Değerlendirme Bulunamadı",description:"Arama kriterinize uygun değerlendirme yok."}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase",children:"Partner / Müşteri"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase",children:"Hizmet"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase",children:"Puan"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase",children:"Yorum"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase",children:"Tarih"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-slate-600 uppercase",children:"Durum"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-bold text-slate-600 uppercase",children:"İşlem"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:g.map(t=>{var r;return e.jsxs("tr",{className:`hover:bg-slate-50 cursor-pointer ${((r=t.objection)==null?void 0:r.status)==="pending"?"bg-orange-50/50":""}`,onClick:()=>x(`/admin/degerlendirmeler/${t.id}`),children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900 text-sm",children:t.partnerName}),e.jsx("p",{className:"text-xs text-slate-500",children:t.customerName})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-700",children:t.service}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[[...Array(5)].map((a,m)=>e.jsx(n,{size:14,className:m<t.rating?h(t.rating):"text-slate-300",fill:m<t.rating?"currentColor":"none"},m)),e.jsx("span",{className:`ml-1 text-sm font-bold ${h(t.rating)}`,children:t.rating})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-sm text-slate-700 line-clamp-2 max-w-xs",children:t.comment})}),e.jsx("td",{className:"px-6 py-4 text-xs text-slate-500 whitespace-nowrap",children:t.date}),e.jsx("td",{className:"px-6 py-4",children:t.objection?e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${t.objection.status==="pending"?"bg-orange-100 text-orange-700":t.objection.status==="approved"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:t.objection.status==="pending"?"İtiraz Bekliyor":t.objection.status==="approved"?"İtiraz Onaylandı":"İtiraz Reddedildi"}):e.jsx("span",{className:"text-xs text-slate-400",children:"-"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("button",{onClick:a=>{a.stopPropagation(),x(`/admin/degerlendirmeler/${t.id}`)},className:"p-2 text-slate-400 hover:text-blue-600 bg-slate-50 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(I,{size:16})})})})]},t.id)})})]})})]})};export{W as default};
